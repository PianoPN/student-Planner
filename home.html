<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å ‚Ä¢ Student Planner</title>
  <link rel="stylesheet" href="assets/style.css"/>
</head>
<body>
<div id="app-header"></div>
<main class="container">
  <div class="toolbar">
    <!-- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ id="welcomeTitle" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ -->
    <h2 id="welcomeTitle">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö üëã</h2>
    <a href="notifications.html"><button class="ghost">üîî ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô <span id="bell" class="badge" style="display:none"></span></button></a>
  </div>

  <section class="card">
    <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h3>
    <div id="todaySummary"></div>
  </section>

  <div class="row">
    <section class="card">
      <h3>‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</h3>
      <ul id="upcoming" class="clean"></ul>
      <p id="noUpcoming" class="empty">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</p>
      <a href="calendar.html"><button class="right">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô</button></a>
    </section>

    <section class="card">
      <h3>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h3>
      <div id="suggestBox"></div>
      <a href="study.html"><button class="ghost">‡∏î‡∏π‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ‚Äú‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‚Äù</button></a>
    </section>
  </div>

  <section class="card">
    <h3>‡πÄ‡∏°‡∏ô‡∏π‡∏•‡∏±‡∏î</h3>
    <div class="row">
      <a href="calendar.html"><button class="ghost">üìÖ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô</button></a>
      <a href="study.html"><button class="ghost">üìñ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô</button></a>
      <a href="timetable.html"><button class="ghost">üóìÔ∏è ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ô</button></a>
      <a href="notifications.html"><button class="ghost">üîî ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</button></a>
    </div>
  </section>
</main>

<script src="assets/app.js"></script>
<script>
  mustAuth();
  ensureDailyPrompts();
  mountHeader('home'); // ‡∏à‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô #welcomeTitle ‡πÄ‡∏õ‡πá‡∏ô "‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö {‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô} üëã"

  // badge ‡∏à‡∏∏‡∏î‡πÅ‡∏î‡∏á
  const cnt = unreadCount(); const bell = document.getElementById('bell');
  if(bell){ bell.style.display = cnt>0?'inline-block':'none'; bell.textContent = cnt; }

  // ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
  const list = upcomingSchedules(5); 
  const ul = document.getElementById('upcoming');
  document.getElementById('noUpcoming').style.display = list.length? 'none':'block';
  ul.innerHTML = list.map(s=>`<li class="card"><b>${s.title}</b><br><small class="muted">${new Date(s.whenISO).toLocaleString()}</small><br><small>${s.notes||''}</small></li>`).join('');

  // ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô
  const sug = nextStudySuggestion();
  document.getElementById('suggestBox').innerHTML = `
    <p><b>‡∏ß‡∏¥‡∏ä‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</b> ${sug.subject}<br><b>‡πÄ‡∏ß‡∏•‡∏≤:</b> ${new Date(sug.whenISO).toLocaleString()} (${sug.durationMin} ‡∏ô‡∏≤‡∏ó‡∏µ)</p>
    <p class="muted">${sug.tip}</p>
    <button id="acceptSug">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô</button>
  `;
  document.getElementById('acceptSug').onclick = ()=>{
    acceptSuggestion(sug);
    alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏õ‡∏î‡∏π‡πÉ‡∏ô‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!');
    location.reload();
  };

  // ‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≤‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ô + ‡∏á‡∏≤‡∏ô‡∏≠‡πà‡∏≤‡∏ô)
  const p = getProfile();
  const dayKey = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'][new Date().getDay()];
  const classes = p.classSchedule[dayKey]||[];
  document.getElementById('todaySummary').innerHTML = `
    <div>üóìÔ∏è ‡∏Ñ‡∏≤‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: <b>${classes.length}</b> ‡∏Ñ‡∏≤‡∏ö</div>
    <div>üîî ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡πà‡∏≤‡∏ô: <b>${cnt}</b> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
  `;
</script>
</body>
</html>
